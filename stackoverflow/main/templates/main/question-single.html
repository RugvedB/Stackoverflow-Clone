<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    <title>Document</title>

    <link rel="stylesheet" href="./main.css">
    <script src="https://cdn.ckeditor.com/4.15.1/standard/ckeditor.js"></script>

</head>
<body>
    <!-- navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <a class="navbar-brand" href="#">Navbar</a>
      
        <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
          <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
            <li class="nav-item active">
              <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Link</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
            </li>
          </ul>
          <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
          </form>
        </div>
      </nav>



    <!-- main -->
    <div class="">
        <div class="row">

            <!-- left (slider type) -->
          <div class="col-md-2 col-sm-0">
            
          </div>




          <!-- Main body right side -->
          <div class="col-md-8 col-sm-12">
            
            <!-- question title -->
            <h2>What is a NullPointerException, and how do I fix it?</h2>
            <p><b>Asked</b> 12 years ago <b>Active</b> 8 days ago <b>Viewed</b> 2.9m times</p>

            <hr>

            <div style="display: flex;flex-direction: row;">
                <!-- left (upvote) -->
                <div style="flex:0.1;display: flex; justify-content: center;" class="pt-2">
                    <div>
                        <div class="triangle-up"></div>
                        <div class="pt-1 pb-1">103</div>
                        <div class="triangle-down"></div>
                    </div>
                </div>
                <!-- right (question) -->
                <div style="flex:0.9;word-break: break-all;" class="p-2">
                    Context: I coded a Kafka Consumer which receives a simple message and I want to insert it to MongoDb using com.mongodb.reactivestreams.client.MongoClient. Althought I understand my issue is all about how use properly MongoClient let me inform my stack: my stack is Micronaut + MongoDb reactive + Kotlin.

                Disclaimer: if someone provide answer in java I may be able to translate it to Kotlin. You can ignore the Kafka part bellow since it is working as expected.

                Here is my code

                package com.mybank.consumer

                import com.mongodb.reactivestreams.client.MongoClient
                import com.mongodb.reactivestreams.client.MongoCollection
                import com.mongodb.reactivestreams.client.MongoDatabase
                import io.micronaut.configuration.kafka.annotation.KafkaKey
                import io.micronaut.configuration.kafka.annotation.KafkaListener
                import io.micronaut.configuration.kafka.annotation.OffsetReset
                import io.micronaut.configuration.kafka.annotation.Topic
                import org.bson.Document
                import org.reactivestreams.Publisher
                import javax.inject.Inject


                @KafkaListener(offsetReset = OffsetReset.EARLIEST)
                class DebitConsumer {

                    @Inject
                    //@Named("another")
                    var mongoClient: MongoClient? = null


                    @Topic("debit")
                    fun receive(@KafkaKey key: String, name: String) {


                        println("Account - $name by $key")

                        
                        var mongoDb : MongoDatabase? = mongoClient?.getDatabase("account")
                        var mongoCollection: MongoCollection<Document>? = mongoDb?.getCollection("account_collection")
                        var mongoDocument: Publisher<Document>? = mongoCollection?.find()?.first()
                        print(mongoDocument.toString())

                        //println(mongoClient?.getDatabase("account")?.getCollection("account_collection")?.find()?.first())
                        //val mongoClientClient: MongoDatabase  = mongoClient.getDatabase("account")
                        //println(mongoClient.getDatabase("account").getCollection("account_collection").find({ "size.h": { $lt: 15 } })
                        //println(mongoClient.getDatabase("account").getCollection("account_collection").find("1").toString())


                    }
                }
                Well, the code above was the closest I got. It is not prompting any error. It is printing

                <!-- Tags -->
                <div>
                    <button class="btn btn-primary btn-sm" type="submit">Button</button>
                    <button class="btn btn-primary btn-sm" type="submit">Button</button>
                    <button class="btn btn-primary btn-sm" type="submit">Button</button>
                    <button class="btn btn-primary btn-sm" type="submit">Button</button>
                </div>

                </div>
            </div>
            


            <!-- User card -->
            <div style="display: flex;justify-content:flex-end; ">
                
                <div style="display: flex;flex-direction: column;width: 250px;">
                    <div>
                        <small>Asked 8 hours ago</small>
                    </div>
                    <div style="display: flex;flex-direction: row;width: 250px;">
                        <div style="flex: 0.3;" class="p-1">
                            <img style="width: 100%;height: 100%;" src="https://images.unsplash.com/photo-1475319122043-5ca9eeceefaf?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80" class="card-img-top" alt="...">
                        </div>
                        <div style="flex: 0.7;" class="p-1">
                            <p><b>Jim C</b><br>322</p>

                        </div>
                    </div>
                </div>

            </div>

            <hr>
            
            

            <!-- Pagination -->
            <nav aria-label="Page navigation example">
                <ul class="pagination">
                  <li class="page-item"><a class="page-link" href="#">Previous</a></li>
                  <li class="page-item"><a class="page-link" href="#">1</a></li>
                  <li class="page-item"><a class="page-link" href="#">2</a></li>
                  <li class="page-item"><a class="page-link" href="#">3</a></li>
                  <li class="page-item"><a class="page-link" href="#">Next</a></li>
                </ul>
            </nav>

            <!-- Answer list -->
            <div style="max-width: 100%;word-break: break-all;">
            <div>
                <div style="display: flex;flex-direction: row;">
                    <!-- left (upvote) -->
                    <div style="flex:0.1;display: flex; justify-content: center;" class=" pt-2">
                        <div>
                            <div class="triangle-up"></div>
                            <div class="pt-1 pb-1">103</div>
                            <div class="triangle-down"></div>
                        </div>
                    </div>
                    <!-- right (question) -->
                    <div style="flex:0.9" class="p-2">
                        You're looking for something that contains "m" somewhere (SQL's '%' operator is equivalent to Regexp's '.*'), not something that has "m" anchored to the beginning of the string.
    note: mongodb uses regular expressions which are more powerful than "LIKE" in sql. With regular expressions you can create any pattern that you imagine.
    For more info on regular expressions refer to this link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions
                    </div>
                </div>
                <div style="display: flex;justify-content:flex-end; ">
                    
                    <div style="display: flex;flex-direction: column;width: 250px;">
                        <div>
                            <small>Asked 8 hours ago</small>
                        </div>
                        <div style="display: flex;flex-direction: row;width: 250px;">
                            <div style="flex: 0.3;" class="p-1">
                                <img style="width: 100%;height: 100%;" src="https://images.unsplash.com/photo-1475319122043-5ca9eeceefaf?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80" class="card-img-top" alt="...">
                            </div>
                            <div style="flex: 0.7;" class="p-1">
                                <p><b>Jim C</b><br>322</p>

                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <hr>

            <div>
                <div style="display: flex;flex-direction: row;">
                    <!-- left (upvote) -->
                    <div style="flex:0.1;display: flex; justify-content: center;" class=" pt-2">
                        <div>
                            <div class="triangle-up"></div>
                            <div class="pt-1 pb-1">103</div>
                            <div class="triangle-down"></div>
                        </div>
                    </div>
                    <!-- right (question) -->
                    <div style="flex:0.9" class=" p-2">
                        You're looking for something that contains "m" somewhere (SQL's '%' operator is equivalent to Regexp's '.*'), not something that has "m" anchored to the beginning of the string.
    note: mongodb uses regular expressions which are more powerful than "LIKE" in sql. With regular expressions you can create any pattern that you imagine.
    For more info on regular expressions refer to this link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions
                    </div>
                </div>

                
                <div style="display: flex;justify-content:flex-end; ">
                    
                    <div style="display: flex;flex-direction: column;width: 250px;">
                        <div>
                            <small>Asked 8 hours ago</small>
                        </div>
                        <div style="display: flex;flex-direction: row;width: 250px;">
                            <div style="flex: 0.3;" class="p-1">
                                <img style="width: 100%;height: 100%;" src="https://images.unsplash.com/photo-1475319122043-5ca9eeceefaf?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80" class="card-img-top" alt="...">
                            </div>
                            <div style="flex: 0.7;" class="p-1">
                                <p><b>Jim C</b><br>322</p>

                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <hr>

            <div>
                <div style="display: flex;flex-direction: row;">
                    <!-- left (upvote) -->
                    <div style="flex:0.1;display: flex; justify-content: center;" class=" pt-2">
                        <div>
                            <div class="triangle-up"></div>
                            <div class="pt-1 pb-1">103</div>
                            <div class="triangle-down"></div>
                        </div>
                    </div>
                    <!-- right (question) -->
                    <div style="flex:0.9" class=" p-2">
                        You're looking for something that contains "m" somewhere (SQL's '%' operator is equivalent to Regexp's '.*'), not something that has "m" anchored to the beginning of the string.
    note: mongodb uses regular expressions which are more powerful than "LIKE" in sql. With regular expressions you can create any pattern that you imagine.
    For more info on regular expressions refer to this link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions
                    </div>
                </div>
                <div style="display: flex;justify-content:flex-end; ">
                    
                    <div style="display: flex;flex-direction: column;width: 250px;">
                        <div>
                            <small>Asked 8 hours ago</small>
                        </div>
                        <div style="display: flex;flex-direction: row;width: 250px;">
                            <div style="flex: 0.3;" class="p-1">
                                <img style="width: 100%;height: 100%;" src="https://images.unsplash.com/photo-1475319122043-5ca9eeceefaf?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80" class="card-img-top" alt="...">
                            </div>
                            <div style="flex: 0.7;" class="p-1">
                                <p><b>Jim C</b><br>322</p>

                            </div>
                        </div>
                    </div>

                </div>
            </div>

            </div>












            <hr>

            <!-- Answer Box editor -->
            <div>
                <h3><b>Your Answer</b></h3>
                <textarea name="editor1"></textarea>
                <script>
                        CKEDITOR.replace( 'editor1' );
                </script>
                <button class="btn btn-primary mt-1" type="submit">Post Answer</button>
            </div>

          </div>


          <!-- <div class="col-md-1 col-sm-0"></div> -->
          <div class="col-md-2 col-sm-0"></div>
        </div>
    </div>
</body>
</html>